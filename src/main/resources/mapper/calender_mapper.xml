<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.book.mypage.dao.CalenderDAO">

	<select id="rentEvents" resultType="CalenderDTO">
		SELECT 
			(select l.library_title from library l where l.library_idx = r.library_idx) AS bookTitle,
			(rent_startdate) AS start, 
			DATE_ADD(rent_enddate, INTERVAL 1 DAY) AS end
		FROM rent r
			WHERE member_idx = 1 AND rent_state IN (2,3,4)
	</select>
	
	<select id="borrowEvents" resultType="CalenderDTO">
		SELECT 
			(SELECT l.library_title FROM library l WHERE l.library_idx = r.library_idx) AS bookTitle, 
			(rent_startdate) AS start,  
			DATE_ADD(rent_enddate, INTERVAL 1 DAY) AS end
		FROM rent r 
		INNER JOIN library l ON r.library_idx IN (SELECT l.library_idx FROM library WHERE library_blind = 0 AND l.member_idx = 1)
			WHERE rent_state in (2,3,4);
	</select>






</mapper>